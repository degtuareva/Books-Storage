
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8" />
    <title>Books List</title>
    <link rel="stylesheet" href="/styles.css"/>
</head>
<body>
<h1>Мои любимые книги</h1>
<table>
    <tr>
        <th>Name</th>
        <th>Author</th>
        <th>Pages</th>
        <th></th>
        <th></th>
    </tr>

    <tr th:each="book: ${books}">
        <td th:text="${book.name}">
        <td th:text="${book.author}">
        <td th:text="${book.pages}">
        <td><a th:href="@{'/edit-form/'+${book.id}}">Edit</a></td>
<!--        <td><a th:href="@{'/delete/'+${book.id}}">Delete</a></td>-->
        <td>
            <a href="javascript:void(0);"
               th:attr="data-id=${book.id}"
               onclick="confirmDelete(this)"
               style="color: red; cursor: pointer;">Delete</a>
        </td>
    </tr>
</table>
<a href="/create-form" class="add-book-link">Add a book</a>
<script>
    function confirmDelete(element) {
        if (confirm('Вы уверены, что хотите удалить эту книгу?')) {
            const bookId = element.getAttribute('data-id');
            fetch('/delete/' + bookId, {
                method: 'POST'
            })
                .then(response => {
                    if (response.ok) {
                        alert('Книга успешно удалена');
                        location.reload();
                    } else {
                        alert('Ошибка при удалении книги');
                    }
                })
                .catch(error => alert('Ошибка: ' + error));
        }
    }
</script>

</body>
</html>